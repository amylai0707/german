<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾·æ–‡å–®å­—æœ¬ ğŸ“š</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #c89f7e 0%, #8b7355 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #8b6f47;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .add-word {
            background: #f5ebe0;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        
        input {
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        select {
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            cursor: pointer;
            transition: border 0.3s;
        }
        
        select:focus {
            outline: none;
            border-color: #a0826d;
        }
        
        input:focus {
            outline: none;
            border-color: #a0826d;
        }
        
        button {
            width: 100%;
            padding: 12px;
            background: #a0826d;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #8b6f47;
        }
        
        .reminder {
            background: #fff8e7;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #d4a574;
        }
        
        .word-list {
            margin-top: 20px;
        }
        
        .word-item {
            background: #f5ebe0;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s;
        }
        
        .word-item:hover {
            transform: translateX(5px);
        }
        
        .word-content {
            flex-grow: 1;
        }
        
        .german {
            font-weight: bold;
            color: #8b6f47;
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .chinese {
            color: #666;
            font-size: 14px;
        }
        
        .sentence {
            color: #8b6f47;
            font-size: 13px;
            font-style: italic;
            margin-top: 5px;
            padding-left: 10px;
            border-left: 3px solid #d4a574;
        }
        
        .category {
            display: inline-block;
            background: #d4a574;
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 12px;
            margin-top: 5px;
        }
        
        .quiz-section {
            background: #f5ebe0;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .quiz-section h3 {
            color: #8b6f47;
            margin-bottom: 15px;
        }
        
        .quiz-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .quiz-question {
            font-size: 24px;
            font-weight: bold;
            color: #8b6f47;
            margin-bottom: 20px;
            text-align: center;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .quiz-answer {
            font-size: 18px;
            color: #666;
            margin-bottom: 20px;
            text-align: center;
            padding: 15px;
            background: #fff8e7;
            border-radius: 8px;
        }
        
        .quiz-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .quiz-buttons button {
            width: auto;
            padding: 10px 20px;
        }
        
        .filter-section {
            background: #f5ebe0;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .filter-section h3 {
            color: #8b6f47;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            width: auto;
            padding: 8px 16px;
            font-size: 14px;
            background: white;
            color: #8b6f47;
            border: 2px solid #d4a574;
        }
        
        .filter-btn:hover {
            background: #d4a574;
            color: white;
        }
        
        .filter-btn.active {
            background: #a0826d;
            color: white;
            border-color: #a0826d;
        }
        
        .export-section {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .export-btn {
            width: auto;
            flex: 1;
            background: #7d9d65;
        }
        
        .export-btn:hover {
            background: #6a8556;
        }
        
        .delete-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .delete-btn:hover {
            background: #ee5a6f;
        }
        
        .stats {
            text-align: center;
            color: #666;
            margin-top: 20px;
            font-size: 14px;
        }
        
        .notification-toggle {
            background: #f5ebe0;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .toggle-btn {
            width: auto;
            padding: 8px 20px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“š æˆ‘çš„å¾·æ–‡å–®å­—æœ¬</h1>
        <p class="subtitle">æ¯å¤©å­¸ä¸€é»ï¼Œå¾·æ–‡æœƒæ›´å¥½ï¼</p>
        
        <div class="notification-toggle">
            <span>ğŸ”” æ¯æ—¥æé†’</span>
            <button class="toggle-btn" id="notificationBtn" onclick="toggleNotification()">
                å•Ÿç”¨é€šçŸ¥
            </button>
        </div>
        
        <div id="reminderBox" class="reminder" style="display: none;">
            â° ä»Šå¤©è©²è¤‡ç¿’å–®å­—äº†ï¼ä½ å·²ç¶“å­¸äº† <span id="todayCount">0</span> å€‹å–®å­—
        </div>
        
        <div class="quiz-section" id="quizSection" style="display: none;">
            <h3>ğŸ¯ éš¨æ©Ÿæ¸¬é©—</h3>
            <div class="quiz-card">
                <div class="quiz-question" id="quizQuestion">é»æ“Šã€Œé–‹å§‹æ¸¬é©—ã€ä¾†æŒ‘æˆ°è‡ªå·±ï¼</div>
                <div class="quiz-answer" id="quizAnswer" style="display: none;"></div>
                <div class="quiz-buttons">
                    <button onclick="startQuiz()" id="startQuizBtn">é–‹å§‹æ¸¬é©—</button>
                    <button onclick="showAnswer()" id="showAnswerBtn" style="display: none;">é¡¯ç¤ºç­”æ¡ˆ</button>
                    <button onclick="nextQuiz()" id="nextQuizBtn" style="display: none;">ä¸‹ä¸€é¡Œ</button>
                </div>
            </div>
        </div>
        
        <div class="filter-section">
            <h3>ğŸ” ç¯©é¸å–®å­—</h3>
            <div class="filter-buttons">
                <button class="filter-btn active" onclick="filterWords('å…¨éƒ¨')">å…¨éƒ¨</button>
                <button class="filter-btn" onclick="filterWords('åè©')">åè©</button>
                <button class="filter-btn" onclick="filterWords('å‹•è©')">å‹•è©</button>
                <button class="filter-btn" onclick="filterWords('å½¢å®¹è©')">å½¢å®¹è©</button>
                <button class="filter-btn" onclick="filterWords('å‰¯è©')">å‰¯è©</button>
                <button class="filter-btn" onclick="filterWords('ä»‹è©')">ä»‹è©</button>
                <button class="filter-btn" onclick="filterWords('ç‰‡èª')">ç‰‡èª</button>
            </div>
        </div>
        
        <div class="export-section">
            <button onclick="exportToPDF()" class="export-btn">ğŸ“„ åŒ¯å‡º PDF</button>
            <button onclick="exportToExcel()" class="export-btn">ğŸ“Š åŒ¯å‡º Excel</button>
        </div>
        
        <div class="add-word">
            <input type="text" id="germanInput" placeholder="å¾·æ–‡å–®å­—ï¼ˆä¾‹å¦‚ï¼šHalloï¼‰" />
            <input type="text" id="chineseInput" placeholder="ä¸­æ–‡æ„æ€ï¼ˆä¾‹å¦‚ï¼šä½ å¥½ï¼‰" />
            <input type="text" id="sentenceInput" placeholder="é€ å¥ï¼ˆé¸å¡«ï¼Œä¾‹å¦‚ï¼šHallo, wie geht es dir?ï¼‰" />
            <select id="categoryInput">
                <option value="åè©">ğŸ·ï¸ åè© (Nomen)</option>
                <option value="å‹•è©">âš¡ å‹•è© (Verb)</option>
                <option value="å½¢å®¹è©">âœ¨ å½¢å®¹è© (Adjektiv)</option>
                <option value="å‰¯è©">ğŸ”„ å‰¯è© (Adverb)</option>
                <option value="ä»‹è©">ğŸ”— ä»‹è© (PrÃ¤position)</option>
                <option value="ç‰‡èª">ğŸ’­ ç‰‡èª (Phrase)</option>
                <option value="å…¶ä»–">ğŸ“¦ å…¶ä»–</option>
            </select>
            <button onclick="addWord()">â• æ–°å¢å–®å­—</button>
        </div>
        
        <div class="word-list" id="wordList"></div>
        
        <div class="stats">
            ç¸½å…±å­¸äº† <strong><span id="totalWords">0</span></strong> å€‹å¾·æ–‡å–®å­— ğŸ‰
        </div>
    </div>

    <script>
        // å„²å­˜å–®å­—åˆ°æœ¬åœ°
        let words = JSON.parse(localStorage.getItem('germanWords') || '[]');
        let notificationEnabled = localStorage.getItem('notificationEnabled') === 'true';
        
        // åˆå§‹åŒ–
        renderWords();
        updateStats();
        checkDailyReminder();
        updateNotificationButton();
        
        // å¦‚æœæœ‰å–®å­—å°±é¡¯ç¤ºæ¸¬é©—å€
        if (words.length > 0) {
            document.getElementById('quizSection').style.display = 'block';
        }
        
        // æ¸¬é©—ç›¸é—œè®Šæ•¸
        let currentQuizWord = null;
        let quizMode = 'german'; // 'german' æˆ– 'chinese'
        
        // é–‹å§‹æ¸¬é©—
        function startQuiz() {
            if (words.length === 0) {
                alert('é‚„æ²’æœ‰å–®å­—å–”ï¼å…ˆåŠ ä¸€äº›å–®å­—å§');
                return;
            }
            
            // éš¨æ©Ÿé¸ä¸€å€‹å–®å­—
            currentQuizWord = words[Math.floor(Math.random() * words.length)];
            
            // éš¨æ©Ÿé¸æ“‡æ¸¬é©—æ¨¡å¼
            quizMode = Math.random() > 0.5 ? 'german' : 'chinese';
            
            // é¡¯ç¤ºå•é¡Œ
            if (quizMode === 'german') {
                document.getElementById('quizQuestion').textContent = currentQuizWord.german;
            } else {
                document.getElementById('quizQuestion').textContent = currentQuizWord.chinese;
            }
            
            // é‡ç½®ç­”æ¡ˆå€
            document.getElementById('quizAnswer').style.display = 'none';
            
            // æ›´æ–°æŒ‰éˆ•
            document.getElementById('startQuizBtn').style.display = 'none';
            document.getElementById('showAnswerBtn').style.display = 'inline-block';
            document.getElementById('nextQuizBtn').style.display = 'none';
        }
        
        // é¡¯ç¤ºç­”æ¡ˆ
        function showAnswer() {
            const answerDiv = document.getElementById('quizAnswer');
            
            if (quizMode === 'german') {
                answerDiv.innerHTML = `
                    <strong>ä¸­æ–‡æ„æ€ï¼š</strong>${currentQuizWord.chinese}<br>
                    ${currentQuizWord.sentence ? `<strong>ä¾‹å¥ï¼š</strong>${currentQuizWord.sentence}<br>` : ''}
                    <strong>åˆ†é¡ï¼š</strong>${currentQuizWord.category}
                `;
            } else {
                answerDiv.innerHTML = `
                    <strong>å¾·æ–‡å–®å­—ï¼š</strong>${currentQuizWord.german}<br>
                    ${currentQuizWord.sentence ? `<strong>ä¾‹å¥ï¼š</strong>${currentQuizWord.sentence}<br>` : ''}
                    <strong>åˆ†é¡ï¼š</strong>${currentQuizWord.category}
                `;
            }
            
            answerDiv.style.display = 'block';
            
            // æ›´æ–°æŒ‰éˆ•
            document.getElementById('showAnswerBtn').style.display = 'none';
            document.getElementById('nextQuizBtn').style.display = 'inline-block';
        }
        
        // ä¸‹ä¸€é¡Œ
        function nextQuiz() {
            startQuiz();
        }
        
        // ç¯©é¸å–®å­—
        function filterWords(category) {
            currentFilter = category;
            renderWords();
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }
        
        // æ–°å¢å–®å­—
        function addWord() {
            const german = document.getElementById('germanInput').value.trim();
            const chinese = document.getElementById('chineseInput').value.trim();
            const sentence = document.getElementById('sentenceInput').value.trim();
            const category = document.getElementById('categoryInput').value;
            
            if (!german || !chinese) {
                alert('è«‹å¡«å¯«å¾·æ–‡å–®å­—å’Œä¸­æ–‡æ„æ€ï¼');
                return;
            }
            
            words.push({
                german: german,
                chinese: chinese,
                sentence: sentence,
                category: category,
                addedDate: new Date().toISOString()
            });
            
            localStorage.setItem('germanWords', JSON.stringify(words));
            
            document.getElementById('germanInput').value = '';
            document.getElementById('chineseInput').value = '';
            document.getElementById('sentenceInput').value = '';
            
            renderWords();
            updateStats();
            
            // å¦‚æœæœ‰å–®å­—å°±é¡¯ç¤ºæ¸¬é©—å€
            if (words.length > 0) {
                document.getElementById('quizSection').style.display = 'block';
            }
        }
        
        // åˆªé™¤å–®å­—
        function deleteWord(index) {
            if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹å–®å­—å—ï¼Ÿ')) {
                words.splice(index, 1);
                localStorage.setItem('germanWords', JSON.stringify(words));
                renderWords();
                updateStats();
            }
        }
        
        // é¡¯ç¤ºæ‰€æœ‰å–®å­—
        let currentFilter = 'å…¨éƒ¨';
        
        function renderWords() {
            const list = document.getElementById('wordList');
            list.innerHTML = '';
            
            const filteredWords = currentFilter === 'å…¨éƒ¨' 
                ? words 
                : words.filter(w => w.category === currentFilter);
            
            filteredWords.forEach((word, index) => {
                const actualIndex = words.indexOf(word);
                const div = document.createElement('div');
                div.className = 'word-item';
                div.innerHTML = `
                    <div class="word-content">
                        <div class="german">${word.german}</div>
                        <div class="chinese">${word.chinese}</div>
                        ${word.sentence ? `<div class="sentence">ğŸ’¬ ${word.sentence}</div>` : ''}
                        <div class="category">${word.category || 'å…¶ä»–'}</div>
                    </div>
                    <button class="delete-btn" onclick="deleteWord(${actualIndex})">åˆªé™¤</button>
                `;
                list.appendChild(div);
            });
            
            if (filteredWords.length === 0 && currentFilter !== 'å…¨éƒ¨') {
                list.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">æ²’æœ‰é€™å€‹åˆ†é¡çš„å–®å­—</p>';
            }
        }
        
        // æ›´æ–°çµ±è¨ˆ
        function updateStats() {
            document.getElementById('totalWords').textContent = words.length;
        }
        
        // æª¢æŸ¥æ¯æ—¥æé†’
        function checkDailyReminder() {
            const lastVisit = localStorage.getItem('lastVisit');
            const today = new Date().toDateString();
            
            if (lastVisit !== today && words.length > 0) {
                document.getElementById('reminderBox').style.display = 'block';
                document.getElementById('todayCount').textContent = words.length;
            }
            
            localStorage.setItem('lastVisit', today);
        }
        
        // åˆ‡æ›é€šçŸ¥
        async function toggleNotification() {
            if (!notificationEnabled) {
                // è«‹æ±‚é€šçŸ¥æ¬Šé™
                if ('Notification' in window) {
                    const permission = await Notification.requestPermission();
                    if (permission === 'granted') {
                        notificationEnabled = true;
                        localStorage.setItem('notificationEnabled', 'true');
                        scheduleDailyNotification();
                        alert('âœ… é€šçŸ¥å·²å•Ÿç”¨ï¼æˆ‘æœƒåœ¨æ¯å¤©æ—©ä¸Š 9 é»æé†’ä½ è¤‡ç¿’å–®å­—');
                    } else {
                        alert('âŒ éœ€è¦é€šçŸ¥æ¬Šé™æ‰èƒ½æé†’ä½ å–”ï¼');
                    }
                } else {
                    alert('âŒ ä½ çš„ç€è¦½å™¨ä¸æ”¯æ´é€šçŸ¥åŠŸèƒ½');
                }
            } else {
                notificationEnabled = false;
                localStorage.setItem('notificationEnabled', 'false');
                alert('ğŸ”• å·²é—œé–‰æ¯æ—¥æé†’');
            }
            updateNotificationButton();
        }
        
        // æ›´æ–°é€šçŸ¥æŒ‰éˆ•æ–‡å­—
        function updateNotificationButton() {
            const btn = document.getElementById('notificationBtn');
            btn.textContent = notificationEnabled ? 'ğŸ”” å·²å•Ÿç”¨' : 'ğŸ”• å•Ÿç”¨é€šçŸ¥';
            btn.style.background = notificationEnabled ? '#7d9d65' : '#a0826d';
        }
        
        // æ’ç¨‹æ¯æ—¥é€šçŸ¥
        function scheduleDailyNotification() {
            if (notificationEnabled && 'Notification' in window && Notification.permission === 'granted') {
                // è¨ˆç®—åˆ°æ˜å¤©æ—©ä¸Š 9 é»çš„æ™‚é–“
                const now = new Date();
                const tomorrow = new Date(now);
                tomorrow.setDate(tomorrow.getDate() + 1);
                tomorrow.setHours(9, 0, 0, 0);
                
                const timeUntilNotification = tomorrow - now;
                
                setTimeout(() => {
                    new Notification('ğŸ“š è©²è¤‡ç¿’å¾·æ–‡å–®å­—äº†ï¼', {
                        body: `ä½ æœ‰ ${words.length} å€‹å–®å­—ç­‰è‘—ä½ è¤‡ç¿’å‘¢ï¼`,
                        icon: 'ğŸ“š'
                    });
                    scheduleDailyNotification(); // å†æ¬¡æ’ç¨‹ä¸‹ä¸€å¤©
                }, timeUntilNotification);
            }
        }
        
        // å¦‚æœå·²å•Ÿç”¨é€šçŸ¥ï¼Œé–‹å§‹æ’ç¨‹
        if (notificationEnabled) {
            scheduleDailyNotification();
        }
        
        // Enter éµå¿«é€Ÿæ–°å¢
        document.getElementById('germanInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('chineseInput').focus();
            }
        });
        
        document.getElementById('chineseInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('sentenceInput').focus();
            }
        });
        
        document.getElementById('sentenceInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                addWord();
                document.getElementById('germanInput').focus();
            }
        });
        
        // åŒ¯å‡ºç‚º PDF
        function exportToPDF() {
            if (words.length === 0) {
                alert('é‚„æ²’æœ‰å–®å­—å–”ï¼');
                return;
            }
            
            // å‰µå»ºä¸€å€‹ç°¡å–®çš„ HTML å…§å®¹
            let content = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>æˆ‘çš„å¾·æ–‡å–®å­—æœ¬</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h1 { color: #8b6f47; }
                        .word { 
                            margin-bottom: 20px; 
                            padding: 15px; 
                            border: 2px solid #d4a574; 
                            border-radius: 8px;
                            page-break-inside: avoid;
                        }
                        .german { font-size: 20px; font-weight: bold; color: #8b6f47; }
                        .chinese { font-size: 16px; color: #666; margin-top: 5px; }
                        .sentence { font-style: italic; color: #8b6f47; margin-top: 5px; }
                        .category { 
                            display: inline-block; 
                            background: #d4a574; 
                            color: white; 
                            padding: 3px 10px; 
                            border-radius: 12px; 
                            font-size: 12px; 
                            margin-top: 5px;
                        }
                    </style>
                </head>
                <body>
                    <h1>ğŸ“š æˆ‘çš„å¾·æ–‡å–®å­—æœ¬</h1>
                    <p>ç¸½å…±å­¸äº† ${words.length} å€‹å¾·æ–‡å–®å­—</p>
                    <p>åŒ¯å‡ºæ—¥æœŸï¼š${new Date().toLocaleDateString('zh-TW')}</p>
                    <hr>
            `;
            
            words.forEach((word, index) => {
                content += `
                    <div class="word">
                        <div class="german">${index + 1}. ${word.german}</div>
                        <div class="chinese">${word.chinese}</div>
                        ${word.sentence ? `<div class="sentence">ğŸ’¬ ${word.sentence}</div>` : ''}
                        <div class="category">${word.category || 'å…¶ä»–'}</div>
                    </div>
                `;
            });
            
            content += `
                </body>
                </html>
            `;
            
            // é–‹å•Ÿæ–°è¦–çª—ä¸¦åˆ—å°
            const printWindow = window.open('', '_blank');
            printWindow.document.write(content);
            printWindow.document.close();
            
            // ç­‰å¾…è¼‰å…¥å®Œæˆå¾Œè‡ªå‹•é–‹å•Ÿåˆ—å°å°è©±æ¡†
            printWindow.onload = function() {
                printWindow.print();
            };
        }
        
        // åŒ¯å‡ºç‚º Excel (CSV æ ¼å¼)
        function exportToExcel() {
            if (words.length === 0) {
                alert('é‚„æ²’æœ‰å–®å­—å–”ï¼');
                return;
            }
            
            // å‰µå»º CSV å…§å®¹
            let csv = '\uFEFF'; // UTF-8 BOM
            csv += 'å¾·æ–‡å–®å­—,ä¸­æ–‡æ„æ€,ä¾‹å¥,åˆ†é¡,æ–°å¢æ—¥æœŸ\n';
            
            words.forEach(word => {
                const sentence = word.sentence ? word.sentence.replace(/,/g, 'ï¼Œ') : '';
                const date = new Date(word.addedDate).toLocaleDateString('zh-TW');
                csv += `"${word.german}","${word.chinese}","${sentence}","${word.category || 'å…¶ä»–'}","${date}"\n`;
            });
            
            // ä¸‹è¼‰ CSV
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `å¾·æ–‡å–®å­—æœ¬_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
